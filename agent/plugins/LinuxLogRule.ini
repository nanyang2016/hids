{"version":"2014103001","LinuxLog":[
{
"rule_id":1000,
"level":6,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*?connection from \"(\\d+.\\d+.\\d+.\\d+)\""
},
"cache":
{
	"time":"$1",
	"pid":"$2",
	"srcip":"$3",
	"message":"来源IP为$3"
}
}
,
{
"rule_id":1001,
"level":6,
"ifid":1007,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*?User (.*?), coming from (\\d+.\\d+.\\d+.\\d+), authenticated"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"$3",
	"srcip":"$4",
	"message":"来源IP为$4的帐户$3通过ssh2成功登陆系统"
}
}
,
{
"rule_id":1002,
"level":6,
"ifid":1000,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*?Wrong password given for user '(.*?)'"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"$3",
	"srcip":"",
	"message":"帐户$3登陆失败"
}
}		
,
{
"rule_id":1003,
"level":6,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*?Accepted password for (.*?) from (\\d+.\\d+.\\d+.\\d+)"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"$3",
	"srcip":"$4",		
	"message":"来源IP为$4的帐户$3通过ssh成功登陆系统"
}
}
,
{
"rule_id":1004,
"level":6,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*?Failed password for (.*?) from (.*?) port"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"$3",
	"srcip":"$4",		
	"message":"来源IP为$4的帐户$3openssh登陆失败"													
}
}
,
{
"rule_id":1005,
"level":6,
"ifid":1000,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*?Public key authentication for user (.*?) accepted"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"$3",
	"srcip":"",
	"message":"帐户$3使用Publickey认证登陆"					
}
}
,
{
"rule_id":1006,
"level":6,
"ifid":1000,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*?pam_ldap: error trying to bind as user \"uid=(.*?),ou=.*\" \\(Invalid credentials\\)"
},
"cache":
{
	"time":"$1",
	"pid":"$2",
	"user":"$3",
	"srcip":"",
	"message":"(ldap协议验证:帐户$3密码错误)"													
}
}
,
{
"rule_id":1007,
"level":6,
"ifid":1000,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*?pam_listfile\\(sshd2:account\\): Refused user (.*?) for service sshd2"
},
"cache":
{
	"time":"$1",
	"pid":"$2",
	"user":"$3",
	"srcip":"",		
	"message":"(ldap协议验证:帐户$3非ldap授权的本地帐户)"													
}
}
,
{
"rule_id":1008,
"level":6,
"ifid":1006,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*?kbd-int:pam: PAM subprocess returned packet SSH_PAM_OP_ERROR. \\(err_num: 7, err_msg: Authentication failure\\)"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"",
	"srcip":"",		
	"message":"ldap认证登陆失败"													
}
}
,
{
"rule_id":1009,
"level":6,
"ifid":1007,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*?kbd-int:pam: PAM subprocess returned packet SSH_PAM_OP_ERROR. \\(err_num: 6, err_msg: Permission denied\\)"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"",
	"srcip":"",		
	"message":"ldap认证登陆失败"													
}
}
,
{
"rule_id":1010,
"level":6,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\]:\\sAccepted.*?pam for (\\w+)\\sfrom\\s(\\d+.\\d+.\\d+.\\d+)\\s"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"$3",
	"srcip":"$4",		
	"message":"pam认证成功"													
}
}
,
{
"rule_id":1011,
"level":6,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[(\\d+)\\].*((Invalid user )|(Authentication failure for ))(\\w+) from (\\d+.\\d+.\\d+.\\d+)"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"$6",
	"srcip":"$7",		
	"message":"pam认证失败"													
}
}
,
{
"rule_id":2004,
"level":10,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?useradd\\[(\\d+)\\]: new account added - account=(.*?), uid=0,.*?by=0"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"$3",
	"message":"$3帐户被添加，且UID=0"													
}
}
,
{
"rule_id":2006,
"level":7,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?su.*?\\(to (.*?)\\)\\s(.*?)\\son (.*)"
},
"sql":
{
	"time":"$1",
	"user":"$3",
	"message":"$3su到$2,tty=$4"													
}
}
,
{
"rule_id":2007,
"level":6,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?su\\:\\sFAILED\\sSU\\s\\(to (.*?)\\)\\s(.*?)\\son (.*)"
},
"sql":
{
	"time":"$1",
	"user":"$3",
	"message":"$3su到$2失败,tty=$4"													
}
}
,
{
"rule_id":2008,
"level":3,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?sudo\\:(.*)"
},
"sql":
{
	"time":"$1",
	"message":"sudo:$2"													
}
}
,
{
"rule_id":2009,
"level":3,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?sudo\\:\\s+(.*?) : command not allowed ;(.*)"
},
"sql":
{
	"time":"$1",
	"user":"$2",
	"message":"$2sudo失败$3"			
}
}
,
{
"rule_id":3005,
"level":6,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?\\[.*?\\].*?device\\s(\\w+)\\sentered promiscuous mode"
},
"sql":
{
	"time":"$1",
	"message":"网卡$2enteredpromiscuousmode"													
}
}
,
{
"rule_id":4001,
"level":6,
"regex":
{
	"line":"(\\w+\\s+\\d+ \\d\\d:\\d\\d:\\d\\d).*?sz\\[(\\d+)\\].*?\\[(.*?)\\] (.*?)/ZMODEM: (\\d+) Bytes"
},
"sql":
{
	"time":"$1",
	"pid":"$2",
	"user":"$3",
	"message":"用户$3使用sz下载了文件$4,$5字节"													
}
}				
]
}
